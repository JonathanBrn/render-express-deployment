<!-- === תפריט צד (Sidebar) === -->
<div id="nav-overlay" class="nav-overlay" onclick="toggleNav()"></div>

<div id="side-nav" class="side-nav">
    <div class="nav-header">
        <div class="nav-logo">תפריט ראשי</div>
        <i class="fa-solid fa-xmark close-btn" onclick="toggleNav()"></i>
    </div>
    
    <ul class="nav-links">
        <li onclick="loadMyTickets()">
            <i class="fa-solid fa-clock-rotate-left"></i>הפניות שלי
        </li>
        <li onclick="alert('יפותח בהמשך: ניהול הרשאות')">
            <i class="fa-solid fa-user-shield"></i> הרשאות
        </li>
        <li onclick="alert('יפותח בהמשך: הגדרות חשבון')">
            <i class="fa-solid fa-gear"></i> הגדרות
        </li>
        <li class="logout-link" onclick="logoutUser()">
            <i class="fa-solid fa-right-from-bracket"></i> התנתקות
        </li>
    </ul>
    
    <div class="nav-footer">Sphere System v1.0</div>
</div>

<!-- === Header קבוע === -->
<header class="navbar">
    <div class="logo" onclick="showScreen('main-menu')">
        <img class="logo-img" src="logo1.png" alt="Sphere Logo">
    </div>
    <div class="hamburger-menu" onclick="toggleNav()">
        <i class="fa-solid fa-bars"></i>
    </div>
</header>

<main class="container">
    <!-- === מסך 1: תפריט ראשי === -->
    <div id="main-menu" class="screen hidden">
        <h1 class="page-title">בחרו את תחום הבקשה שלכם</h1>
        <div class="grid-menu">
            <div class="menu-item" onclick="showScreen('entry-permit-screen')">
                <div class="icon-circle">
                    <img src="https://cdn-icons-png.flaticon.com/512/3344/3344835.png" class="img-icon">
                </div>
                <span class="label">אישורי כניסה</span>
            </div>
            <div class="menu-item" onclick="alert('טרם פותח')">
                <div class="icon-circle"><img src="https://cdn-icons-png.flaticon.com/512/679/679720.png" class="img-icon"></div>
                <span class="label">ציוד ואספקה</span>
            </div>
            <div class="menu-item" onclick="showScreen('maintenance-screen')">
                <div class="icon-circle"><img src="https://cdn-icons-png.flaticon.com/512/1077/1077198.png" class="img-icon"></div>
                <span class="label">בינוי ואחזקה</span>
            </div>
            <div class="menu-item" onclick="alert('טרם פותח')">
                <div class="icon-circle"><img src="https://cdn-icons-png.flaticon.com/512/3067/3067451.png" class="img-icon"></div>
                <span class="label">מחשוב</span>
            </div>
            <div class="menu-item disabled">
                <div class="badge">בקרוב!</div>
                <div class="icon-circle grayscale">
                    <img src="https://cdn-icons-png.flaticon.com/512/3202/3202926.png" alt="רכבים" class="img-icon">
                </div>
                <span class="label">חניות</span>
            </div>
             <div class="menu-item disabled">
                <div class="badge">בקרוב!</div>
                <div class="icon-circle grayscale">
                    <img src="https://cdn-icons-png.flaticon.com/512/1441/1441180.png" alt="רכבים" class="img-icon">
                </div>
                <span class="label">מענה לפרט</span>
            </div>
            <div class="menu-item disabled">
                <div class="badge">בקרוב!</div>
                <div class="icon-circle grayscale">
                    <img src="https://cdn-icons-png.flaticon.com/512/2693/2693507.png" alt="אירועים" class="img-icon">
                </div>
                <span class="label">אירועים</span>
            </div>
            <div class="menu-item disabled">
                <div class="badge">בקרוב!</div>
                <div class="icon-circle grayscale">
                    <img src="https://cdn-icons-png.flaticon.com/512/4091/4091459.png" alt="אירועים" class="img-icon">
                </div>
                <span class="label">גרפיקה ודיגיטל</span>
            </div>
        </div>
    </div>

    <!-- === מסך 2: טופס תחזוקה === -->
    <div id="maintenance-screen" class="screen hidden">
        <div class="back-btn" onclick="showScreen('main-menu')">
            <i class="fa-solid fa-arrow-right"></i> חזרה לתפריט
        </div>
        <h2 class="form-title">דיווח תקלת בינוי</h2>
        <p class="form-subtitle">אנא מלאו את פרטי התקלה במדויק</p>
        
        <form class="modern-form" onsubmit="submitMaintenanceForm(event)">
            <div class="form-group">
                <label>סוג התקלה</label>
                <div class="select-wrapper">
                    <select id="m_type" required>
                        <option value="" disabled selected>בחר נושא...</option>
                        <option value="air_condition">מיזוג אוויר</option>
                        <option value="electricity">חשמל</option>
                        <option value="plumbing">אינסטלציה</option>
                        <option value="furniture">ריהוט / נגרות</option>
                        <option value="general">אחזקה כללית</option>
                    </select>
                    <i class="fa-solid fa-chevron-down select-arrow"></i>
                </div>
            </div>
            <div class="form-group">
                <label>פירוט התקלה</label>
                <textarea id="m_description" rows="3" placeholder="לדוגמה: המזגן לא עובד בכלל..." required></textarea>
            </div>
            <div class="form-group">
                <label>מספר מזגן / נכס <small>(חובה במיזוג)</small></label>
                <input id="m_asset_num" type="text" placeholder="לדוגמה: 25267 טדיראן">
            </div>
            <div class="form-group">
                <label>מיקום התקלה</label>
                <div class="input-with-icon">
                    <i class="fa-solid fa-location-dot"></i>
                    <input id="m_location" type="text" placeholder="לדוגמה: משרד מנהלן" required>
                </div>
            </div>
            <div class="form-group">
                <label>אחראי ענפי + שם ענף</label>
                <input id="m_manager" type="text" placeholder="לדוגמה: ורוניקה לביא, ענף מע&quot;מ">
            </div>
            <div class="grid-2-cols">
                <div class="form-group">
                    <label>שם איש קשר</label>
                    <input id="m_contact_name" type="text" placeholder="שם מלא" required>
                </div>
                <div class="form-group">
                    <label>טלפון</label>
                    <input id="m_phone" type="tel" class="locked-input" readonly>
                </div>
            </div>
            <div class="form-group">
                <label>הערות נוספות</label>
                <textarea id="m_notes" rows="2" placeholder="הערות למבצע..."></textarea>
            </div>
            <button type="submit" class="submit-btn">
                שלח קריאה <i class="fa-solid fa-paper-plane"></i>
            </button>
        </form>
    </div>

    <!-- === מסך 3: טופס אישור כניסה === -->
    <div id="entry-permit-screen" class="screen hidden">
        <div class="back-btn" onclick="showScreen('main-menu')">
            <i class="fa-solid fa-arrow-right"></i> חזרה לתפריט
        </div>
        <h2 class="form-title">בקשת אישור כניסה</h2>
        <p class="form-subtitle">מלאו את פרטי המבקר לצורך קבלת אישור</p>
        <form class="modern-form" onsubmit="submitEntryPermit(event)">
            <div class="form-group">
                <label>שם מלא</label>
                <div class="input-with-icon">
                    <i class="fa-regular fa-user"></i>
                    <input id="ep_fullname" type="text" placeholder="שם פרטי ושם משפחה" required>
                </div>
            </div>
            <div class="grid-2-cols">
                <div class="form-group">
                    <label>מס' אישי / ת.ז</label>
                    <input id="ep_id_num" type="tel" placeholder="מספר זיהוי" required>
                </div>
                <div class="form-group">
                    <label>טלפון נייד</label>
                    <input id="ep_phone" type="tel" placeholder="050..." required>
                </div>
            </div>
            <div class="grid-2-cols">
                <div class="form-group">
                    <label>שיוך אוכלוסיה</label>
                    <div class="select-wrapper">
                        <select id="ep_status" required>
                            <option value="" disabled selected>בחר...</option>
                            <option value="soldier">איש צבא</option>
                            <option value="civilian">אזרח עובד צה"ל</option>
                            <option value="contractor">קבלן / ספק</option>
                            <option value="guest">אזרח / אורח</option>
                        </select>
                        <i class="fa-solid fa-chevron-down select-arrow"></i>
                    </div>
                </div>
                <div class="form-group">
                    <label>סיווג בטחוני</label>
                    <div class="select-wrapper">
                        <select id="ep_security" required>
                            <option value="" disabled selected>בחר סיווג...</option>
                            <option value="5">5</option>
                            <option value="4">4</option>
                            <option value="3">3</option>
                            <option value="2">2</option>
                            <option value="1">1</option>
                            <option value="none">ללא סיווג</option>
                        </select>
                        <i class="fa-solid fa-chevron-down select-arrow"></i>
                    </div>
                </div>
            </div>
            <div class="grid-2-cols">
                <div class="form-group">
                    <label>מספר רכב</label>
                    <input id="ep_car_num" type="text" placeholder="אם קיים">
                </div>
                <div class="form-group">
                    <label>צבע רכב</label>
                    <input id="ep_car_color" type="text" placeholder="לדוגמה: לבן">
                </div>
            </div>
            <div class="form-group">
                <label>מטרת הביקור</label>
                <textarea id="ep_purpose" rows="2" placeholder="פירוט סיבת הכניסה..." required></textarea>
            </div>
            <div class="form-group">
                <label>טווח תאריכים מבוקש</label>
                <div class="grid-2-cols">
                    <div class="input-with-icon">
                        <input id="ep_date_start" type="text" onfocus="(this.type='date')" placeholder="מתאריך">
                    </div>
                    <div class="input-with-icon">
                        <input id="ep_date_end" type="text" onfocus="(this.type='date')" placeholder="עד תאריך">
                    </div>
                </div>
            </div>
            <button type="submit" class="submit-btn" style="background: linear-gradient(135deg, #10b981 0%, #059669 100%);">
                שלח בקשת כניסה <i class="fa-solid fa-check"></i>
            </button>
        </form>
    </div>

    <!-- === מסך 4: הפניות שלי === -->
    <div id="my-tickets-screen" class="screen hidden">
        <div class="back-btn" onclick="showScreen('main-menu')">
            <i class="fa-solid fa-arrow-right"></i> חזרה לתפריט
        </div>
        <h2 class="form-title">הפניות שלי</h2>
        <p class="form-subtitle">סטטוס טיפול בקריאות פתוחות וסגורות</p>
        <div id="tickets-container" class="tickets-grid">
            <div style="text-align: center; width: 100%; margin-top: 50px; color: #94a3b8;">
                <i class="fa-solid fa-spinner fa-spin fa-2x"></i>
                <p>טוען נתונים...</p>
            </div>
        </div>
    </div>

    <!-- === Modal === -->
    <div id="ticket-modal" class="modal-overlay hidden" onclick="closeTicketModal(event)">
        <div class="modal-content card-animation">
            <div class="modal-header">
                <h3 id="modal-title">פרטי קריאה</h3>
                <div class="close-modal" onclick="closeTicketModal(event, true)">
                    <i class="fa-solid fa-xmark"></i>
                </div>
            </div>
            <div class="modal-body">
                <div class="status-badge-large" id="modal-status">---</div>
                <div class="detail-row">
                    <span class="detail-label">מספר קריאה:</span>
                    <span class="detail-value" id="modal-id">---</span>
                </div>
                <div id="modal-dynamic-content"></div>
                <div class="detail-footer">
                    <small id="modal-date">---</small>
                </div>
            </div>
        </div>
    </div>

<!-- רשימת הסקריפטים למשתמש רגיל -->
<div id="script-manifest" 
     data-scripts="binui.js,navbar.js,logout.js,ticket.js,entry_permit.js,startup_check.js, show_screen.js" 
     style="display:none;">
</div>

</main>